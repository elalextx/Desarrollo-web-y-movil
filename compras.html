<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Natural Power - Compras</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body>

<div id="navbarContainer"></div>

<div class="container mt-5">
    <h3>Lista de compras</h3>
    <table class="table table-bordered" id="comprasTable">
        <thead>
            <tr>
                <th>#ID Compra</th>
                <th>Compra</th>
                <th>Cantidad</th>
                <th>Precio total</th>
                <th>Fecha</th>
                <th>Estado</th>
                <th>Acci√≥n</th>
            </tr>
        </thead>
        <tbody></tbody>
    </table>
</div>

<script src="js/db.js"></script>
<script src="js/compras.js"></script>
<script src="js/navbar.js"></script>

<script>
    document.addEventListener("DOMContentLoaded", () => {
        const tbody = document.querySelector("#comprasTable tbody");
        const compras = getCompras();

        if (compras.length === 0) {
            tbody.innerHTML = `<tr><td colspan="7" class="text-center">No hay compras realizadas.</td></tr>`;
            return;
        }

        compras.forEach((compra, index) => {
            const row = document.createElement("tr");
            row.innerHTML = `
                <td>#${compra.id}</td>
                <td>${compra.productos.join(", ")}</td>
                <td>${compra.cantidades.map(c => "x" + c).join(", ")}</td>
                <td>$${compra.total.toLocaleString()}</td>
                <td>${compra.fecha}</td>
                <td>${compra.estado}</td>
                <td>
                    ${
                        compra.estado === "Completada"
                            ? `<button class="btn btn-warning btn-sm" onclick="solicitarReembolso(${index})">Solicitar reembolso</button>`
                            : `<button class="btn btn-secondary btn-sm" disabled>No disponible</button>`
                    }
                </td>
            `;
            tbody.appendChild(row);
        });
    });
</script>

</body>
</html>